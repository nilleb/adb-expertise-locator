{
    "_source": {
        "includes": [
            "fullname",
            "keywords.keyword",
            "keywords.count",
            "links"
        ]
    },
    "query": {
        "bool": {
            "should": [
                {
                    "match": {
                        "fullname": {
                            "query": "{{query_string}}",
                            "boost": 2
                        }
                    }
                },
                {
                    "fuzzy": {
                        "fullname": {"value": "{{query_string}}", "boost": 1.2}
                    }
                  },
                          {
                    "match": {
                        "texts": {
                            "query": "{{query_string}}",
                            "analyzer": "search_synonyms"
                        }
                    }
                },
                {
                    "nested": {
                        "path": "keywords",
                        "score_mode": "sum",
                        "query": {
                            "function_score": {
                                "query": {
                                    "match": {
                                        "keywords.keyword": "{{query_string}}"
                                    }
                                },
                                "field_value_factor": {
                                    "field": "keywords.count"
                                }
                            }
                        }
                    }
                }
            ],
            "minimum_should_match": 1
        }
    },
    "highlight": {
        "require_field_match": false,
        "max_analyzed_offset": 10000,
        "fields": {
            "texts_cut": {
                "pre_tags": "<strong>",
                "post_tags": "</strong>"
            }
        }
    },
    "suggest": {
        "text": "{{query_string}}",
        "suggest-1": {
            "term": {
                "field": "fullname"
            }
        },
        "suggest-2": {
            "term": {
                "field": "keywords.keyword"
            }
        }
    }
}